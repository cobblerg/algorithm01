<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>일상 생활 속 알고리즘 흐름도 만들기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .problem-btn.selected {
            background-color: #3b82f6; /* bg-blue-600 */
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 14px 0 rgb(0 118 255 / 39%);
        }
        .step-card-source {
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        .step-card-source:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .step-card-source.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background-color: #f3f4f6;
            transform: none;
            box-shadow: none;
        }
        .step-card-target {
             cursor: pointer;
        }
        .flowchart-arrow {
            font-size: 2rem;
            color: #6b7280; /* text-gray-500 */
            line-height: 1;
        }
        .placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            height: 100%;
            min-height: 150px;
            border: 2px dashed #d1d5db;
            border-radius: 0.5rem;
            color: #6b7280;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 flex flex-col items-center p-4 sm:p-6 md:p-8 min-h-screen">

    <div class="w-full max-w-6xl mx-auto">
        <!-- 제목 -->
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">일상 생활 속 알고리즘 흐름도 만들기</h1>
            <p class="text-md md:text-lg text-gray-600 mt-2">문제를 선택하고, 순서에 맞게 단계를 클릭하여 나만의 흐름도를 완성해 보세요!</p>
        </header>

        <main class="bg-white rounded-2xl shadow-lg p-6 w-full">
            <!-- 1. 문제 선택 단계 -->
            <section id="problem-selection" class="mb-6">
                <h2 class="text-xl font-semibold mb-3 text-blue-700">1. 문제 선택하기</h2>
                <div id="problem-buttons" class="flex flex-wrap gap-3">
                    <!-- 문제 버튼이 동적으로 추가될 영역 -->
                </div>
            </section>
            
            <!-- 2. 알고리즘 구성 영역 -->
            <div class="grid md:grid-cols-2 gap-6 mb-6">
                <!-- 좌측: 선택할 단계 -->
                <section id="algorithm-source">
                    <h2 class="text-xl font-semibold mb-3 text-purple-700">2. 선택할 단계 (순서 섞임)</h2>
                    <div id="steps-source-container" class="bg-purple-50 p-4 rounded-lg min-h-[200px]">
                        <div id="steps-source-placeholder" class="placeholder">
                            <p>먼저 위에서 해결할 문제를 선택해 주세요.</p>
                        </div>
                        <div id="steps-source-grid" class="grid grid-cols-2 lg:grid-cols-3 gap-3"></div>
                    </div>
                </section>
                
                <!-- 우측: 나의 알고리즘 순서 -->
                <section id="algorithm-target">
                    <h2 class="text-xl font-semibold mb-3 text-orange-700">3. 나의 알고리즘 순서</h2>
                    <div id="steps-target-container" class="bg-orange-50 p-4 rounded-lg min-h-[200px]">
                        <div id="steps-target-placeholder" class="placeholder">
                             <p>왼쪽의 단계를 순서에 맞게 클릭하여<br>여기에 추가하세요.</p>
                        </div>
                        <div id="steps-target-list" class="flex flex-col gap-2"></div>
                    </div>
                </section>
            </div>
            
            <!-- 3. 기능 버튼 -->
            <section id="controls" class="flex flex-wrap justify-center gap-3 mb-6">
                <button id="check-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none" disabled>
                    순서 확인하기
                </button>
                <button id="hint-btn" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none" disabled>
                    힌트 보기
                </button>
                <button id="reset-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg shadow-md transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none" disabled>
                    다시하기
                </button>
            </section>
            
            <!-- 4. 흐름도 표시 영역 -->
            <section id="flowchart-section">
                <h2 class="text-xl font-semibold mb-3 text-green-700">4. 흐름도 완성!</h2>
                <div id="flowchart-container" class="p-4 bg-green-50 rounded-lg flex-wrap items-center justify-center gap-2 hidden overflow-x-auto">
                    <!-- 흐름도가 동적으로 생성될 영역 -->
                </div>
                 <div id="flowchart-placeholder" class="placeholder">
                    <p>알고리즘 순서를 맞추면 여기에 흐름도가 나타납니다.</p>
                </div>
            </section>
        </main>
    </div>

    <!-- 결과 및 힌트 모달 -->
    <div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-md text-center">
            <h3 id="modal-title" class="text-2xl font-bold mb-4">결과</h3>
            <div id="modal-content" class="text-lg mb-6"></div>
            <button id="modal-close-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-8 rounded-lg transition-colors">
                닫기
            </button>
        </div>
    </div>

<script>
const problems = {
    'ramen': {
        title: '컵라면 끓이기',
        steps: [
            { id: 1, title: '물 끓이기', description: '전기 포트에 물을 넣고 끓여요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-red-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2c2.4 0 4.5 1.2 6 3h-2.2c-.3-1-1.3-1.8-2.8-1.8s-2.5.8-2.8 1.8H8c1.5-1.8 3.6-3 6-3zM5.1 5.1C3.8 6.4 3 8.2 3 10v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-4c0-1.8-.8-3.6-2.1-4.9l-1-1C16.5 2.8 14.4 2 12 2s-4.5.8-6 2.1l-1 1zM3 18h18v1c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2v-1z"/><path d="M8 22h8"/><path d="M12 16V8"/><path d="m9 13 3 3 3-3"/><path d="M7 5c.5-1.2 1.5-2 3-2"/><path d="M14 5c-.5-1.2-1.5-2-3-2"/></svg>`, hint: '가장 먼저 해야 할 일은 뜨거운 물을 준비하는 것이에요. 라면을 익히려면 물이 팔팔 끓어야겠죠?'},
            { id: 2, title: '스프 넣기', description: '컵라면 뚜껑을 열고 분말 스프를 넣어요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-yellow-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.5 8.5v-6a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0-.5.5v6c0 1.4-1.1 2.5-2.5 2.5h-1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1c-1.4 0-2.5-1.1-2.5-2.5Z"/><path d="M20.5 16.5a1 1 0 0 0-1-1h-1c-1.4 0-2.5-1.1-2.5-2.5v-6a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 0-.5.5v6c0 1.4-1.1 2.5-2.5 2.5h-1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2Z"/><path d="M3.5 11.5a1 1 0 0 0-1-1h-1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1Z"/><circle cx="6" cy="18" r="1"/><circle cx="10" cy="18" r="1"/><circle cx="14" cy="18" r="1"/><circle cx="18" cy="18" r="1"/></svg>`, hint: '뜨거운 물을 붓기 전에 면 위에 스프를 골고루 뿌려주는 것이 좋아요. 그래야 맛이 잘 섞여요.'},
            { id: 3, title: '물 붓기', description: '끓는 물을 컵라면 안쪽 표시선까지 부어요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-blue-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 14 4-4"/><path d="M3.33 4C2.5 5.3 2 6.9 2 8.5 2 12.5 5.5 18 12 18s10-5.5 10-9.5c0-1.6-.5-3.2-1.33-4.5"/><path d="M14 2v2"/><path d="M17 3v2"/><path d="M19 5v2"/></svg>`, hint: '이제 준비된 뜨거운 물을 라면이 잠기도록 부어줄 차례예요. 너무 많거나 적지 않게 표시선을 잘 보세요.'},
            { id: 4, title: '기다리기', description: '뚜껑을 덮고 3분 동안 면이 익기를 기다려요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>`, hint: '면이 충분히 익으려면 시간이 필요해요. 보통 3분에서 4분 정도 기다려야 맛있는 라면이 완성돼요.'},
            { id: 5, title: '맛있게 먹기', description: '면이 다 익으면 잘 저어서 맛있게 먹어요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-orange-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 21h10"/><path d="M4.2 12.8c.2-2.3 2.2-4.2 4.6-4.2h6.4c2.4 0 4.4 1.9 4.6 4.2L20 16H4l.2-3.2Z"/><path d="M5.3 5.4C6.8 6.9 8.8 8 12 8s5.2-1.1 6.7-2.6"/><path d="M12 2v2"/></svg>`, hint: '모든 과정이 끝났어요! 이제 맛있게 먹을 시간이에요. 이 단계는 항상 마지막에 오겠죠?'},
        ]
    },
    'sandwich': {
        title: '샌드위치 만들기',
        steps: [
            { id: 1, title: '빵 준비', description: '식빵 두 조각을 준비해요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-yellow-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 11a8.5 8.5 0 0 1-17 0V9c0-2.8 2.2-5 5-5h7c2.8 0 5 2.2 5 5v2z"/><path d="M20 11v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-2"/></svg>`, hint: '샌드위치의 기본은 빵이죠. 가장 먼저 샌드위치의 틀이 될 빵을 준비해야 합니다.'},
            { id: 2, title: '속재료 올리기', description: '빵 위에 햄, 치즈, 채소를 올려요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h8z"/><path d="M6 8h4"/><path d="M6 12h4"/><path d="M6 16h4"/><path d="M14 4h6v12h-6z"/></svg>`, hint: '준비된 빵 한쪽에 맛있는 속재료들을 차곡차곡 쌓아 올릴 차례입니다.'},
            { id: 3, title: '빵 덮기', description: '남은 빵 한 조각으로 위를 덮어요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-yellow-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 8.7c2.5-1.8 5.3-1.8 7.8 0 2.5 1.8 5.3 1.8 7.8 0"/><path d="M5 13.2c2.5-1.8 5.3-1.8 7.8 0 2.5 1.8 5.3 1.8 7.8 0"/><path d="M20 11a8.5 8.5 0 0 1-17 0V9c0-2.8 2.2-5 5-5h7c2.8 0 5 2.2 5 5v2z"/><path d="M20 11v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-2"/></svg>`, hint: '속재료를 다 올렸다면, 나머지 빵으로 덮어서 샌드위치 형태를 완성해야겠죠?'},
            { id: 4, title: '자르기', description: '먹기 좋게 반으로 잘라요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H18a2 2 0 0 1 2 2v3.5L12 15l-4 4-2-2 9.5-9.5z"/><path d="m18 6-3.5-3.5"/></svg>`, hint: '완성된 샌드위치를 그냥 먹어도 좋지만, 깔끔하게 반으로 자르면 먹기 더 편하답니다.'},
        ]
    },
     'recycling': {
        title: '분리수거하기',
        steps: [
            { id: 1, title: '비우고 헹구기', description: '용기 안의 내용물을 비우고 물로 헹궈요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-blue-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 12h.01"/><path d="M15 12h.01"/><path d="M10 18.5c.3.2.5.4.8.5s.6.2.9.2c1.2 0 2.3-.6 3-1.5c.8-1 1.5-2.3 1.5-3.5A6 6 0 0 0 6 9c0 1 .2 2.2 1.5 3.5c.7.9 1.8 1.5 3 1.5.3 0 .6 0 .9-.2.3-.1.5-.3.8-.5Z"/><path d="M9 12a3 3 0 0 0 6 0"/><path d="M12 22a10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8V22Z"/><path d="M2 12h2a8 8 0 0 1 8 8v2a10 10 0 0 0-10-10Z"/></svg>`, hint: '재활용품을 깨끗하게 만들기 위한 첫 단계입니다. 음식물이나 이물질이 남아있지 않도록 해야 해요.'},
            { id: 2, title: '라벨 제거', description: '페트병이나 플라스틱 용기의 비닐 라벨을 떼요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-teal-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>`, hint: '재활용 효율을 높이기 위해 다른 재질은 분리해야 합니다. 비닐 라벨은 플라스틱과 다르니까요.'},
            { id: 3, title: '분류하기', description: '플라스틱, 비닐, 종이, 캔 등으로 나눠요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-indigo-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 6h-4a2 2 0 0 0-2 2v2H9V8a2 2 0 0 0-2-2H3"/><path d="M3 14h4a2 2 0 0 0 2-2v-2h6v2a2 2 0 0 0 2 2h4"/><path d="M12 4v4"/><path d="M12 12v4"/></svg>`, hint: '가장 중요한 단계! 재활용품을 종류에 맞게 정확히 구분해야 합니다.'},
            { id: 4, title: '압축하여 배출', description: '부피를 줄여 지정된 장소에 내놓아요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-green-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 11 12 14 15 11"/><path d="M12 14V3"/><path d="M21 14v5a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-5"/></svg>`, hint: '분류가 끝났다면 이제 버릴 차례입니다. 페트병 등은 밟아서 부피를 줄이면 더 좋아요.'},
        ]
    },
    'cpr': {
        title: '심폐소생술',
        steps: [
            { id: 1, title: '의식 확인 및 신고', description: '어깨를 두드리며 환자의 의식을 확인하고 119에 신고해요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-red-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.3 18.9c.4.4 1 .4 1.4 0l.6-.6a1 1 0 0 0 0-1.4l-7.1-7.1-1-1a1 1 0 0 0-1.4 0l-1.5 1.5-1 1L3 18.2a1 1 0 0 0 0 1.4l.6.6c.4.4 1 .4 1.4 0L12 13l1.5 1.5L20.3 18.9z"/><path d="M22 18v-4c0-1.1-.9-2-2-2h-4"/><path d="M12.5 11.5 8 7"/></svg>`, hint: '심폐소생술의 가장 첫 단계는 환자의 상태를 확인하고 주변에 도움을 요청하는 것입니다.'},
            { id: 2, title: '기도 확보', description: '머리를 젖히고 턱을 들어 올려 기도를 열어줘요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12c-3 0-5 2.5-5 2.5s2 2.5 5 2.5 5-2.5 5-2.5-2-2.5-5-2.5Z"/><path d="M12 12v-2"/><path d="M12 7V6"/><path d="m9 10 1.5-1.5"/><path d="m15 10-1.5-1.5"/></svg>`, hint: '숨을 쉴 수 있는 통로를 만들어주는 중요한 과정입니다. 신고 후에 즉시 시행해야 해요.'},
            { id: 3, title: '가슴 압박 30회', description: '가슴 중앙을 약 5cm 깊이로 30번 강하고 빠르게 눌러요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-orange-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/><path d="M3.22 12H9.5l.7-1.5L11 12h4.8"/></svg>`, hint: '심장을 대신하여 혈액을 순환시키는 핵심 단계입니다. 정확한 위치를 강하고 빠르게 압박해야 해요.'},
            { id: 4, title: '인공호흡 2회', description: '코를 막고 입으로 숨을 2번 불어넣어요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-green-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12a4 4 0 0 0-4 4c0 1.5 2.5 3 4 3s4-1.5 4-3a4 4 0 0 0-4-4Z"/><path d="M12 21a2 2 0 0 0 2-2h-4a2 2 0 0 0 2 2Z"/><path d="M12 2a2 2 0 0 0-2 2h4a2 2 0 0 0-2-2Z"/><path d="M12 6a2 2 0 1 0-4 0"/><path d="M12 6a2 2 0 1 1 4 0"/></svg>`, hint: '가슴 압박 후에는 환자에게 산소를 공급해주어야 합니다. 가슴이 부풀어 오르는지 확인하며 불어넣어요.'},
            { id: 5, title: '반복하기', description: '119가 도착할 때까지 가슴압박과 인공호흡을 반복해요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 20A10 10 0 1 0 2.5 9.5"/><path d="M2.5 13.5V9.5H6.5"/><path d="m14 10-4 4 2.5 2.5"/><path d="m13.5 12.5 2.5 2.5"/></svg>`, hint: '환자의 생명을 구하기 위해 가장 중요한 것은 포기하지 않고 구조대가 올 때까지 계속하는 것입니다.'},
        ]
    },
    'fire': {
        title: '화재 시 대처하기',
        steps: [
            { id: 1, title: '"불이야!" 외치기', description: '큰 소리로 외쳐 화재 사실을 주변에 알려요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-yellow-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 8a4 4 0 0 1 4 4v.7a3.3 3.3 0 0 0-3-1.7c-1.8 0-3.3 1.5-3.3 3.3s1.5 3.3 3.3 3.3a3.3 3.3 0 0 0 3-1.7V16a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V8a4 4 0 0 1 4-4h4z"/><path d="M18 12h-6"/><path d="M12 8V4"/><path d="m8 4 1.5 2.5"/><path d="m16 4-1.5 2.5"/></svg>`, hint: '화재를 가장 먼저 발견했을 때 할 일은 주변 사람들에게 위험을 알리는 것입니다.'},
            { id: 2, title: '비상벨 누르기', description: '가장 가까운 화재 비상벨을 눌러요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-red-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a7 7 0 0 0-7 7c0 3 2 5 2 7h10c0-2 2-4 2-7a7 7 0 0 0-7-7z"/><path d="M12 21a2 2 0 0 0 2-2h-4a2 2 0 0 0 2 2z"/><path d="M10.3 2.2a2 2 0 0 1 3.4 0"/><path d="M14 15h-4"/></svg>`, hint: '소리치는 것과 동시에 건물 전체에 화재 사실을 알리기 위해 비상벨을 눌러야 합니다.'},
            { id: 3, title: '젖은 수건으로 입/코 막기', description: '연기 흡입을 막기 위해 젖은 수건을 사용해요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-cyan-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12c-3.2 4-8.8 4-12 0-3.2-4 0-10.8 0-10.8s5.2 3.2 8 0c2.8-3.2 0-9.2 0-9.2s4.8 4.8 4 8c-.8 3.2-3.2 4-4 4Z"/><path d="m2 12 5 5"/><path d="m7 12-5 5"/></svg>`, hint: '화재 시 가장 위험한 것은 유독가스입니다. 젖은 수건으로 호흡기를 보호하는 것이 중요해요.'},
            { id: 4, title: '낮은 자세로 대피', description: '유독가스를 피해 최대한 낮은 자세로 이동해요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-gray-700" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="5" r="1"/><path d="M12 8v8"/><path d="M12 16l-3.5 4"/><path d="M12 16l3.5 4"/><path d="M9 11h6"/><path d="M8 8l-2 3h12l-2-3"/></svg>`, hint: '뜨거운 공기와 유독가스는 위로 올라가는 성질이 있습니다. 바닥에 가까운 맑은 공기를 마시며 대피해야 합니다.'},
            { id: 5, title: '안전한 곳에서 119 신고', description: '건물 밖 안전한 곳으로 나온 뒤 119에 신고해요.', icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 3h2a2 2 0 0 1 2 2v2"/><path d="M8 3H6a2 2 0 0 0-2 2v2"/><path d="M12 3v18"/><path d="M16 21h-2a2 2 0 0 1-2-2v-2"/><path d="M8 21H6a2 2 0 0 1-2-2v-2"/><path d="M12 21V3"/></svg>`, hint: '나의 안전을 먼저 확보하는 것이 가장 중요합니다. 무리하게 불을 끄려 하지 말고, 대피 후 신속하게 신고합니다.'},
        ]
    }
};

let currentProblemKey = null;

const problemButtonsContainer = document.getElementById('problem-buttons');
const stepsSourcePlaceholder = document.getElementById('steps-source-placeholder');
const stepsSourceGrid = document.getElementById('steps-source-grid');
const stepsTargetPlaceholder = document.getElementById('steps-target-placeholder');
const stepsTargetList = document.getElementById('steps-target-list');
const flowchartContainer = document.getElementById('flowchart-container');
const flowchartPlaceholder = document.getElementById('flowchart-placeholder');
const checkBtn = document.getElementById('check-btn');
const hintBtn = document.getElementById('hint-btn');
const resetBtn = document.getElementById('reset-btn');
const modal = document.getElementById('modal');
const modalTitle = document.getElementById('modal-title');
const modalContent = document.getElementById('modal-content');
const modalCloseBtn = document.getElementById('modal-close-btn');

// 초기화 함수
function initialize() {
    Object.keys(problems).forEach(key => {
        const problem = problems[key];
        const button = document.createElement('button');
        button.textContent = problem.title;
        button.className = 'problem-btn bg-white hover:bg-blue-500 hover:text-white text-blue-500 font-semibold py-2 px-4 border border-blue-500 rounded-lg shadow transition-all duration-300';
        button.dataset.problemKey = key;
        button.addEventListener('click', () => selectProblem(key));
        problemButtonsContainer.appendChild(button);
    });
    
    checkBtn.addEventListener('click', checkOrder);
    hintBtn.addEventListener('click', showHint);
    resetBtn.addEventListener('click', resetSteps);
    modalCloseBtn.addEventListener('click', () => modal.classList.add('hidden'));
}

// 문제 선택
function selectProblem(key) {
    currentProblemKey = key;
    
    document.querySelectorAll('.problem-btn').forEach(btn => {
        btn.classList.toggle('selected', btn.dataset.problemKey === key);
    });

    renderSourceSteps();
    resetTargetSteps();
    
    checkBtn.disabled = false;
    hintBtn.disabled = false;
    resetBtn.disabled = false;
}

// 좌측 '선택할 단계' 렌더링
function renderSourceSteps() {
    if (!currentProblemKey) return;

    stepsSourcePlaceholder.style.display = 'none';
    stepsSourceGrid.innerHTML = '';
    
    const steps = problems[currentProblemKey].steps;
    const shuffledSteps = [...steps].sort(() => Math.random() - 0.5);

    shuffledSteps.forEach(step => {
        const stepCard = document.createElement('div');
        stepCard.className = 'step-card-source bg-white p-3 rounded-lg shadow border flex flex-col items-center justify-center text-center gap-2';
        stepCard.dataset.id = step.id;
        
        stepCard.innerHTML = `
            ${step.icon}
            <h4 class="font-bold text-sm">${step.title}</h4>
        `;
        stepCard.addEventListener('click', handleSourceStepClick);
        stepsSourceGrid.appendChild(stepCard);
    });
}

// 우측 '나의 알고리즘 순서' 초기화
function resetTargetSteps() {
    stepsTargetList.innerHTML = '';
    stepsTargetPlaceholder.style.display = 'flex';
    flowchartContainer.style.display = 'none';
    flowchartPlaceholder.style.display = 'flex';
}

// 좌측 단계 클릭 핸들러
function handleSourceStepClick() {
    if (this.classList.contains('disabled')) return;

    const stepId = this.dataset.id;
    const step = problems[currentProblemKey].steps.find(s => s.id == stepId);

    this.classList.add('disabled');
    stepsTargetPlaceholder.style.display = 'none';
    
    const targetCard = document.createElement('div');
    targetCard.className = 'step-card-target bg-white p-2 rounded-lg shadow-sm border flex items-center justify-between';
    targetCard.dataset.id = step.id;
    targetCard.innerHTML = `
        <div class="flex items-center gap-3">
            ${step.icon}
            <span class="font-semibold">${step.title}</span>
        </div>
        <button class="text-red-500 hover:text-red-700 font-bold text-xl pr-2">&times;</button>
    `;
    
    targetCard.querySelector('button').addEventListener('click', () => {
        // 원래 소스 카드 활성화
        const sourceCard = stepsSourceGrid.querySelector(`.step-card-source[data-id='${stepId}']`);
        if (sourceCard) {
            sourceCard.classList.remove('disabled');
        }
        // 타겟 카드 삭제
        targetCard.remove();
        if (stepsTargetList.children.length === 0) {
            stepsTargetPlaceholder.style.display = 'flex';
        }
    });

    stepsTargetList.appendChild(targetCard);
}

// '다시하기' 버튼 기능
function resetSteps() {
    if (currentProblemKey) {
        renderSourceSteps();
        resetTargetSteps();
    }
}

// 순서 확인
function checkOrder() {
    const currentOrder = [...stepsTargetList.children].map(card => card.dataset.id);
    const correctOrder = problems[currentProblemKey].steps.map(step => String(step.id));
    
    const isCorrect = JSON.stringify(currentOrder) === JSON.stringify(correctOrder);

    modalTitle.textContent = isCorrect ? '정답입니다! 🎉' : '아쉬워요! 🤔';
    modalContent.textContent = isCorrect ? '알고리즘 순서를 완벽하게 맞췄어요! 아래 생성된 흐름도를 확인해 보세요.' : '순서가 조금 다른 것 같아요. 우측 목록의 X 버튼으로 순서를 바꾸거나, [다시하기]로 처음부터 시작해 보세요.';
    modal.classList.remove('hidden');

    if (isCorrect) {
        generateFlowchart();
    }
}

// 힌트 보기
function showHint() {
    modalTitle.textContent = '힌트 보기 💡';
    const hints = problems[currentProblemKey].steps.map(step => 
        `<div class="text-left mb-3 p-3 bg-gray-100 rounded-lg">
            <p class="font-bold text-purple-700">${step.id}. ${step.title}</p>
            <p class="text-sm text-gray-700">${step.hint}</p>
        </div>`
    ).join('');
    modalContent.innerHTML = `<div class="max-h-80 overflow-y-auto pr-2">${hints}</div>`;
    modal.classList.remove('hidden');
}

// 흐름도 생성
function generateFlowchart() {
    flowchartContainer.innerHTML = '';
    flowchartPlaceholder.style.display = 'none';
    flowchartContainer.style.display = 'flex';

    const steps = problems[currentProblemKey].steps;

    steps.forEach((step, index) => {
        const stepElement = document.createElement('div');
        stepElement.className = 'flex flex-col items-center text-center p-2 flex-shrink-0';
        stepElement.innerHTML = `
            ${step.icon.replace('h-10 w-10', 'h-12 w-12')}
            <p class="font-semibold mt-1 text-sm">${step.title}</p>
            <p class="text-xs text-gray-600">${step.description}</p>
        `;
        flowchartContainer.appendChild(stepElement);

        if (index < steps.length - 1) {
            const arrowElement = document.createElement('div');
            arrowElement.className = 'flowchart-arrow self-center mx-2';
            arrowElement.innerHTML = `&rightarrow;`;
            flowchartContainer.appendChild(arrowElement);
        }
    });
}

// 프로그램 시작
initialize();
</script>

</body>
</html>

